{"remainingRequest":"/myp/vue/sell/node_modules/vue-loader/lib/index.js??vue-loader-options!/myp/vue/sell/src/components/goods/goods.vue?vue&type=style&index=0&lang=stylus&rel=stylesheet%2Fstylus&","dependencies":[{"path":"/myp/vue/sell/src/components/goods/goods.vue","mtime":1580813218874},{"path":"/myp/vue/sell/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/myp/vue/sell/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/myp/vue/sell/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/myp/vue/sell/node_modules/stylus-loader/index.js","mtime":1519606876000},{"path":"/myp/vue/sell/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/myp/vue/sell/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKDQpAaW1wb3J0ICdjb21tb24vc3R5bHVzL21peGluLnN0eWwnDQoNCiAgLmdvb2RzDQogICAgZGlzcGxheTogZmxleA0KICAgIHBvc2l0aW9uOiBhYnNvbHV0ZQ0KICAgIHRvcDogMTc0cHgNCiAgICBib3R0b206IDQ2cHgNCiAgICB3aWR0aDogMTAwJQ0KICAgIG92ZXJmbG93OiBoaWRkZW4NCiAgICAubWVudS13cmFwcGVyDQogICAgICBkaXNwbGF5OiBmbGV4DQogICAgICBmbGV4OiAwIDAgODBweCAgLy/nrYnliIYg57yp5pS+IOWNoOS9jeepuumXtA0KICAgICAgd2lkdGg6IDgwcHgNCiAgICAgIGJhY2tncm91bmQtY29sb3I6ICNmM2Y1ZjcNCiAgICAgIGZsZXgtZmxvdzogY29sdW1uIHdyYXANCiAgICAgIC5tZW51LWl0ZW0NCiAgICAgICAgZGlzcGxheTogdGFibGUNCiAgICAgICAgd2lkdGg6IDU2cHgNCiAgICAgICAgaGVpZ2h0OiA1NHB4DQogICAgICAgIHBhZGRpbmc6IDAgMTJweA0KICAgICAgICBsaW5lLWhlaWdodDogMTRweA0KICAgICAgICBmb250LXdlaWdodDogMjAwDQogICAgICAgICYuY3VycmVudA0KICAgICAgICAgIHBvc2l0aW9uOiByZWxhdGl2ZQ0KICAgICAgICAgIGZvbnQtc2l6ZTogMTJweA0KICAgICAgICAgIG1hcmdpbi10b3A6IC0xcHgNCiAgICAgICAgICBsaW5lLWhlaWdodDogMTRweA0KICAgICAgICAgIGJhY2tncm91bmQ6ICNmZmYNCiAgICAgICAgICBmb250LXdlaWdodDogNzAwDQogICAgICAgIC50ZXh0DQogICAgICAgICAgZGlzcGxheTogdGFibGUtY2VsbA0KICAgICAgICAgIHdpZHRoOiA1NnB4DQogICAgICAgICAgdmVydGljYWwtYWxpZ246IG1pZGRsZQ0KICAgICAgICAgIGJvcmRlci0xcHgocmdiYSg3LCAxNywgMjcsIC4xKSkNCiAgICAgICAgICBmb250LXNpemU6IDEycHgNCg0KICAgIC5mb29kcy13cmFwcGVyDQogICAgICBmbGV4OiAxDQogICAgICAuaXRlbS10aXRsZQ0KICAgICAgICBkaXNwbGF5OiBibG9jaw0KICAgICAgICB3aWR0aDogMTAwJQ0KICAgICAgICBoZWlnaHQ6IDI2cHgNCiAgICAgICAgcGFkZGluZy1sZWZ0OiAxNHB4DQogICAgICAgIGJvcmRlci1sZWZ0OiAycHggc29saWQgI2Q5ZGRlMQ0KICAgICAgICBsaW5lLWhlaWdodDogMjZweA0KICAgICAgICBmb250LXNpemU6IDEycHgNCiAgICAgICAgY29sb3I6IHJnYigxNDcsIDE1MywgMTU5KQ0KICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZjNmNWY3DQogICAgICAuZm9vZC1pdGVtDQogICAgICAgIGRpc3BsYXk6IGZsZXgNCiAgICAgICAgbWFyZ2luOiAxOHB4IDE4cHggMA0KICAgICAgICBwYWRkaW5nLWJvdHRvbTogMThweA0KICAgICAgICBib3JkZXItMXB4KHJnYmEoNywgMTcsIDI3LCAuMSkpDQogICAgICAgIC5jb250ZW50LXN3aXBwZXINCiAgICAgICAgICB3aWR0aDogMTAwJQ0KICAgICAgICAgICY6bGFzdC1jaGlsZDphZnRlcg0KICAgICAgICAgICAgZGlzcGxheTogbm9uZQ0KICAgICAgICAgIC5pY29uDQogICAgICAgICAgICBmbGV4OiAwIDAgNTdweA0KICAgICAgICAgICAgbWFyZ2luLXJpZ2h0OiAxMHB4DQogICAgICAgICAgLmNvbnRlbnQNCiAgICAgICAgICAgIGRpc3BsYXk6IGlubGluZS1ibG9jaw0KICAgICAgICAgICAgZmxleDogMQ0KICAgICAgICAgICAgLm5hbWUNCiAgICAgICAgICAgICAgbWFyZ2luOiAycHggMCA4cHggMA0KICAgICAgICAgICAgICBoZWlnaHQ6IDE0cHgNCiAgICAgICAgICAgICAgbGluZS1oZWlnaHQ6IDE0cHgNCiAgICAgICAgICAgICAgZm9udC1zaXplOiAxNHB4DQogICAgICAgICAgICAgIGNvbG9yOiByZ2IoNywxIDE3LCAyNykNCiAgICAgICAgICAgIC5kZXNjDQogICAgICAgICAgICAgIG1hcmdpbjogOHB4IDANCiAgICAgICAgICAgICAgZm9udC1zaXplOiAxMHB4DQogICAgICAgICAgICAgIGxpbmUtaGVpZ2h0OiAxNHB4DQogICAgICAgICAgICAgIGNvbG9yOiByZ2IoMTQ3LCAxNTMsIDE1OSkNCiAgICAgICAgICAgICAgdGV4dC1vdmVyZmxvdzogZWxsaXBzaXMNCiAgICAgICAgICAgIC5leHRyYQ0KICAgICAgICAgICAgICBmb250LXNpemU6IDEwcHgNCiAgICAgICAgICAgICAgbGluZS1oZWlnaHQ6IDEwcHgNCiAgICAgICAgICAgICAgY29sb3I6IHJnYigxNDcsIDE1MywgMTU5KQ0KICAgICAgICAgICAgICAuY291bnQNCiAgICAgICAgICAgICAgICBtYXJnaW4tcmlnaHQ6IDEycHgNCiAgICAgICAgICAgIC5wcmljZQ0KICAgICAgICAgICAgICAubmV3LXByaWNlDQogICAgICAgICAgICAgICAgZm9udC1zaXplOiAxNHB4DQogICAgICAgICAgICAgICAgY29sb3I6IHJnYigyNDAsMjAsMjApDQogICAgICAgICAgICAgICAgZm9udC13ZWlnaHQ6IDMwMA0KICAgICAgICAgICAgICAgIGxpbmUtaGVpZ2h0OiAyNHB4DQogICAgICAgICAgICAgIC5vbGQtcHJpY2UNCiAgICAgICAgICAgICAgICBmb250LXNpemU6IDEwcHgNCiAgICAgICAgICAgICAgICBjb2xvcjogcmdiKDE0NywgMTUzLCAxNTkpDQogICAgICAgICAgICAgICAgZm9udC13ZWlnaHQ6IDMwMA0KICAgICAgICAgICAgICAgIHRleHQtZGVjb3JhdGlvbjogbGluZS10aHJvdWdoDQogICAgICAgIC5jYXJ0Y29udHJvbC13cmFwcGVyDQogICAgICAgICAgcG9zaXRpb246IGFic29sdXRlDQogICAgICAgICAgYm90dG9tOiAxMHB4DQogICAgICAgICAgcmlnaHQ6IDBweA0KDQo="},{"version":3,"sources":["goods.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2LA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"goods.vue","sourceRoot":"src/components/goods","sourcesContent":["<template>\r\n  <div class=\"goods\">\r\n    <div class=\"menu-wrapper\" ref=\"menuWrapper\">\r\n      <ul>\r\n        <li\r\n          v-for=\"(item, index) in goods\"\r\n          :key=\"index\" class=\"menu-item\"\r\n          :class=\"{'current': currentIndex === index}\"\r\n          @click=\"selectMenu(index, $event)\"\r\n        >\r\n          <span class=\"text\">\r\n            <Icon\r\n              v-show=\"item.type > 0\"\r\n              :itemType = \"item.type\"\r\n              :size = \"312\"\r\n            ></Icon>\r\n            {{item.name}}\r\n          </span>\r\n        </li>\r\n      </ul>\r\n    </div>\r\n    <div class=\"foods-wrapper\" ref=\"foodsWrapper\">\r\n      <ul>\r\n        <li v-for=\"(good, index) in goods\" :key=index class=\"food-list-hook\">\r\n          <ul>\r\n            <span class=\"item-title\">{{good.name}}</span>\r\n            <li\r\n              v-for=\"(item, i) in good.foods\"\r\n              :key=i class=\"food-item\"\r\n            >\r\n              <div class=\"content-swipper\" @click.stop=\"selectFood(item, $event)\">\r\n                <div class=\"icon\">\r\n                  <img width=\"57px\" height=\"57px\" :src=\"item.icon\" alt=\"\">\r\n                </div>\r\n                <div class=\"content\">\r\n                  <h2 class=\"name\">{{item.name}}</h2>\r\n                  <p class=\"desc\">{{item.description}}</p>\r\n                  <div class=\"extra\">\r\n                    <span class=\"count\">月售{{item.sellCount}}份</span>\r\n                    <span>好评率{{item.rating}}</span>\r\n                  </div>\r\n                  <div class=\"price\">\r\n                    <span class=\"new-price\">￥{{item.price}}</span>\r\n                    <span v-show=\"good.oldPrice\" class=\"old-price\">￥{{good.oldPrice}}</span>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <!-- 增加减少控件 -->\r\n              <div class=\"cartcontrol-wrapper\">\r\n                <CartControl\r\n                  :food=\"item\"\r\n                >\r\n                </CartControl>\r\n              </div>\r\n            </li>\r\n          </ul>\r\n        </li>\r\n      </ul>\r\n    </div>\r\n    <ShoopCart\r\n      :deliveryPri=\"seller.deliveryPrice\"\r\n      :minPri=\"seller.minPrice\"\r\n      :selectFoods=\"selectFoods\"\r\n    ></ShoopCart>\r\n    <Food\r\n      :food=\"selectedFood\"\r\n      ref=\"food\"\r\n    ></Food>\r\n  </div>\r\n</template>\r\n\r\n<script type=\"text/ecmascript-6\">\r\nimport Icon from 'components/icon/icon.vue'\r\nimport ShoopCart from 'components/shoopcart/shoopcart.vue'\r\nimport CartControl from 'components/cartcontrol/cartcontrol.vue'\r\nimport Food from 'components/food/food.vue'\r\nimport BScroll from '@better-scroll/core'\r\n\r\nconst ERRNO_OK = 0\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      goods: [],\r\n      listHeight: [],\r\n      scrollY: 0,\r\n      selectedFood: {}\r\n    }\r\n  },\r\n  props: {\r\n    seller: Object\r\n  },\r\n  methods: {\r\n    _initScroll: function() {\r\n      // 获取到这个food-wrapper dom\r\n      this.meunScrll = new BScroll(this.$refs.menuWrapper, {\r\n        click: true\r\n      })\r\n      this.foodsScrll = new BScroll(this.$refs.foodsWrapper, {\r\n        // 会阻止默认行为，需要设置\r\n        click: true,\r\n        // 监听scroll\r\n        probeType: 3\r\n      })\r\n      this.foodsScrll.on('scroll', (pos) => {\r\n        this.scrollY = Math.abs(Math.round(pos.y))\r\n      })\r\n    },\r\n    // 每个类型的高度\r\n    _calculateHeight: function() {\r\n      let foodList = this.$refs.foodsWrapper.getElementsByClassName('food-list-hook')\r\n      // console.log(foodList)\r\n      let height = 0\r\n      this.listHeight.push(height)\r\n      for (let i = 0; i < foodList.length; i++) {\r\n        let item = foodList[i]\r\n        height += item.clientHeight\r\n        this.listHeight.push(height)\r\n      }\r\n    },\r\n    selectMenu: function (index, event) {\r\n      if (!event._constructed) {\r\n        return\r\n      }\r\n      let foodList = this.$refs.foodsWrapper.getElementsByClassName('food-list-hook')\r\n      let el = foodList[index]\r\n      this.foodsScrll.scrollToElement(el, 300)\r\n      this.scrollY = Math.abs(this.listHeight[index])\r\n    },\r\n    selectFood: function (food, event) {\r\n      if (!event._constructed) {\r\n        return\r\n      }\r\n      this.selectedFood = food\r\n      this.$refs.food.show()\r\n    }\r\n  },\r\n  computed: {\r\n    currentIndex: function () {\r\n      for (let i = 0; i < this.listHeight.length - 1; i++) {\r\n        let height1 = this.listHeight[i]\r\n        let height2 = this.listHeight[i + 1]\r\n        if (!height2 || (this.scrollY >= height1 && this.scrollY < height2)) {\r\n          return i\r\n        }\r\n      }\r\n      return 0\r\n    },\r\n    selectFoods: function() {\r\n      let foods = []\r\n      this.goods.forEach((good) => {\r\n        good.foods.forEach((food) => {\r\n          if (food.count) {\r\n            foods.push(food)\r\n          }\r\n        })\r\n      })\r\n      return foods\r\n    }\r\n  },\r\n  created() {\r\n    this.$http.get('http://selladmin.bfclouds.cn/goods.php', {}, { emulateJSON: true }).then((res) => {\r\n      res = res.body\r\n      console.log(res)\r\n      if (res.errno === ERRNO_OK) {\r\n        this.goods = res.data\r\n        console.log(this.goods)\r\n        // 处理DOM时一定要保证dom已经渲染\r\n        this.$nextTick(() => {\r\n          this._initScroll()\r\n          this._calculateHeight()\r\n        })\r\n      }\r\n    }).catch((res) => {\r\n      this.goods = []\r\n    })\r\n  },\r\n  components: {\r\n    Icon,\r\n    ShoopCart,\r\n    CartControl,\r\n    Food\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"stylus\" rel=\"stylesheet/stylus\">\r\n@import 'common/stylus/mixin.styl'\r\n\r\n  .goods\r\n    display: flex\r\n    position: absolute\r\n    top: 174px\r\n    bottom: 46px\r\n    width: 100%\r\n    overflow: hidden\r\n    .menu-wrapper\r\n      display: flex\r\n      flex: 0 0 80px  //等分 缩放 占位空间\r\n      width: 80px\r\n      background-color: #f3f5f7\r\n      flex-flow: column wrap\r\n      .menu-item\r\n        display: table\r\n        width: 56px\r\n        height: 54px\r\n        padding: 0 12px\r\n        line-height: 14px\r\n        font-weight: 200\r\n        &.current\r\n          position: relative\r\n          font-size: 12px\r\n          margin-top: -1px\r\n          line-height: 14px\r\n          background: #fff\r\n          font-weight: 700\r\n        .text\r\n          display: table-cell\r\n          width: 56px\r\n          vertical-align: middle\r\n          border-1px(rgba(7, 17, 27, .1))\r\n          font-size: 12px\r\n\r\n    .foods-wrapper\r\n      flex: 1\r\n      .item-title\r\n        display: block\r\n        width: 100%\r\n        height: 26px\r\n        padding-left: 14px\r\n        border-left: 2px solid #d9dde1\r\n        line-height: 26px\r\n        font-size: 12px\r\n        color: rgb(147, 153, 159)\r\n        background-color: #f3f5f7\r\n      .food-item\r\n        display: flex\r\n        margin: 18px 18px 0\r\n        padding-bottom: 18px\r\n        border-1px(rgba(7, 17, 27, .1))\r\n        .content-swipper\r\n          width: 100%\r\n          &:last-child:after\r\n            display: none\r\n          .icon\r\n            flex: 0 0 57px\r\n            margin-right: 10px\r\n          .content\r\n            display: inline-block\r\n            flex: 1\r\n            .name\r\n              margin: 2px 0 8px 0\r\n              height: 14px\r\n              line-height: 14px\r\n              font-size: 14px\r\n              color: rgb(7,1 17, 27)\r\n            .desc\r\n              margin: 8px 0\r\n              font-size: 10px\r\n              line-height: 14px\r\n              color: rgb(147, 153, 159)\r\n              text-overflow: ellipsis\r\n            .extra\r\n              font-size: 10px\r\n              line-height: 10px\r\n              color: rgb(147, 153, 159)\r\n              .count\r\n                margin-right: 12px\r\n            .price\r\n              .new-price\r\n                font-size: 14px\r\n                color: rgb(240,20,20)\r\n                font-weight: 300\r\n                line-height: 24px\r\n              .old-price\r\n                font-size: 10px\r\n                color: rgb(147, 153, 159)\r\n                font-weight: 300\r\n                text-decoration: line-through\r\n        .cartcontrol-wrapper\r\n          position: absolute\r\n          bottom: 10px\r\n          right: 0px\r\n\r\n</style>\r\n"]}]}