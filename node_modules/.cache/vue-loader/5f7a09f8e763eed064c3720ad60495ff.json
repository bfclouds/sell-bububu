{"remainingRequest":"/myp/vue/sell/node_modules/vue-loader/lib/index.js??vue-loader-options!/myp/vue/sell/src/components/goods/goods.vue?vue&type=style&index=0&lang=stylus&rel=stylesheet%2Fstylus&","dependencies":[{"path":"/myp/vue/sell/src/components/goods/goods.vue","mtime":1580813475598},{"path":"/myp/vue/sell/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/myp/vue/sell/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/myp/vue/sell/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/myp/vue/sell/node_modules/stylus-loader/index.js","mtime":1519606876000},{"path":"/myp/vue/sell/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/myp/vue/sell/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCg0KQGltcG9ydCAnY29tbW9uL3N0eWx1cy9taXhpbi5zdHlsJw0KDQogIC5nb29kcw0KICAgIGRpc3BsYXk6IGZsZXgNCiAgICBwb3NpdGlvbjogYWJzb2x1dGUNCiAgICB0b3A6IDE3NHB4DQogICAgYm90dG9tOiA0NnB4DQogICAgd2lkdGg6IDEwMCUNCiAgICBvdmVyZmxvdzogaGlkZGVuDQogICAgLm1lbnUtd3JhcHBlcg0KICAgICAgZGlzcGxheTogZmxleA0KICAgICAgZmxleDogMCAwIDgwcHggIC8v562J5YiGIOe8qeaUviDljaDkvY3nqbrpl7QNCiAgICAgIHdpZHRoOiA4MHB4DQogICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZjNmNWY3DQogICAgICBmbGV4LWZsb3c6IGNvbHVtbiB3cmFwDQogICAgICAubWVudS1pdGVtDQogICAgICAgIGRpc3BsYXk6IHRhYmxlDQogICAgICAgIHdpZHRoOiA1NnB4DQogICAgICAgIGhlaWdodDogNTRweA0KICAgICAgICBwYWRkaW5nOiAwIDEycHgNCiAgICAgICAgbGluZS1oZWlnaHQ6IDE0cHgNCiAgICAgICAgZm9udC13ZWlnaHQ6IDIwMA0KICAgICAgICAmLmN1cnJlbnQNCiAgICAgICAgICBwb3NpdGlvbjogcmVsYXRpdmUNCiAgICAgICAgICBmb250LXNpemU6IDEycHgNCiAgICAgICAgICBtYXJnaW4tdG9wOiAtMXB4DQogICAgICAgICAgbGluZS1oZWlnaHQ6IDE0cHgNCiAgICAgICAgICBiYWNrZ3JvdW5kOiAjZmZmDQogICAgICAgICAgZm9udC13ZWlnaHQ6IDcwMA0KICAgICAgICAudGV4dA0KICAgICAgICAgIGRpc3BsYXk6IHRhYmxlLWNlbGwNCiAgICAgICAgICB3aWR0aDogNTZweA0KICAgICAgICAgIHZlcnRpY2FsLWFsaWduOiBtaWRkbGUNCiAgICAgICAgICBib3JkZXItMXB4KHJnYmEoNywgMTcsIDI3LCAuMSkpDQogICAgICAgICAgZm9udC1zaXplOiAxMnB4DQoNCiAgICAuZm9vZHMtd3JhcHBlcg0KICAgICAgZmxleDogMQ0KICAgICAgLml0ZW0tdGl0bGUNCiAgICAgICAgZGlzcGxheTogYmxvY2sNCiAgICAgICAgd2lkdGg6IDEwMCUNCiAgICAgICAgaGVpZ2h0OiAyNnB4DQogICAgICAgIHBhZGRpbmctbGVmdDogMTRweA0KICAgICAgICBib3JkZXItbGVmdDogMnB4IHNvbGlkICNkOWRkZTENCiAgICAgICAgbGluZS1oZWlnaHQ6IDI2cHgNCiAgICAgICAgZm9udC1zaXplOiAxMnB4DQogICAgICAgIGNvbG9yOiByZ2IoMTQ3LCAxNTMsIDE1OSkNCiAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogI2YzZjVmNw0KICAgICAgLmZvb2QtaXRlbQ0KICAgICAgICBkaXNwbGF5OiBmbGV4DQogICAgICAgIG1hcmdpbjogMThweCAxOHB4IDANCiAgICAgICAgcGFkZGluZy1ib3R0b206IDE4cHgNCiAgICAgICAgYm9yZGVyLTFweChyZ2JhKDcsIDE3LCAyNywgLjEpKQ0KICAgICAgICAuY29udGVudC1zd2lwcGVyDQogICAgICAgICAgd2lkdGg6IDEwMCUNCiAgICAgICAgICAmOmxhc3QtY2hpbGQ6YWZ0ZXINCiAgICAgICAgICAgIGRpc3BsYXk6IG5vbmUNCiAgICAgICAgICAuaWNvbg0KICAgICAgICAgICAgZmxleDogMCAwIDU3cHgNCiAgICAgICAgICAgIG1hcmdpbi1yaWdodDogMTBweA0KICAgICAgICAgIC5jb250ZW50DQogICAgICAgICAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2sNCiAgICAgICAgICAgIGZsZXg6IDENCiAgICAgICAgICAgIC5uYW1lDQogICAgICAgICAgICAgIG1hcmdpbjogMnB4IDAgOHB4IDANCiAgICAgICAgICAgICAgaGVpZ2h0OiAxNHB4DQogICAgICAgICAgICAgIGxpbmUtaGVpZ2h0OiAxNHB4DQogICAgICAgICAgICAgIGZvbnQtc2l6ZTogMTRweA0KICAgICAgICAgICAgICBjb2xvcjogcmdiKDcsMSAxNywgMjcpDQogICAgICAgICAgICAuZGVzYw0KICAgICAgICAgICAgICBtYXJnaW46IDhweCAwDQogICAgICAgICAgICAgIGZvbnQtc2l6ZTogMTBweA0KICAgICAgICAgICAgICBsaW5lLWhlaWdodDogMTRweA0KICAgICAgICAgICAgICBjb2xvcjogcmdiKDE0NywgMTUzLCAxNTkpDQogICAgICAgICAgICAgIHRleHQtb3ZlcmZsb3c6IGVsbGlwc2lzDQogICAgICAgICAgICAuZXh0cmENCiAgICAgICAgICAgICAgZm9udC1zaXplOiAxMHB4DQogICAgICAgICAgICAgIGxpbmUtaGVpZ2h0OiAxMHB4DQogICAgICAgICAgICAgIGNvbG9yOiByZ2IoMTQ3LCAxNTMsIDE1OSkNCiAgICAgICAgICAgICAgLmNvdW50DQogICAgICAgICAgICAgICAgbWFyZ2luLXJpZ2h0OiAxMnB4DQogICAgICAgICAgICAucHJpY2UNCiAgICAgICAgICAgICAgLm5ldy1wcmljZQ0KICAgICAgICAgICAgICAgIGZvbnQtc2l6ZTogMTRweA0KICAgICAgICAgICAgICAgIGNvbG9yOiByZ2IoMjQwLDIwLDIwKQ0KICAgICAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiAzMDANCiAgICAgICAgICAgICAgICBsaW5lLWhlaWdodDogMjRweA0KICAgICAgICAgICAgICAub2xkLXByaWNlDQogICAgICAgICAgICAgICAgZm9udC1zaXplOiAxMHB4DQogICAgICAgICAgICAgICAgY29sb3I6IHJnYigxNDcsIDE1MywgMTU5KQ0KICAgICAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiAzMDANCiAgICAgICAgICAgICAgICB0ZXh0LWRlY29yYXRpb246IGxpbmUtdGhyb3VnaA0KICAgICAgICAuY2FydGNvbnRyb2wtd3JhcHBlcg0KICAgICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZQ0KICAgICAgICAgIGJvdHRvbTogMTBweA0KICAgICAgICAgIHJpZ2h0OiAwcHgNCg0K"},{"version":3,"sources":["goods.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyLA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"goods.vue","sourceRoot":"src/components/goods","sourcesContent":["<template>\r\n  <div class=\"goods\">\r\n    <div class=\"menu-wrapper\" ref=\"menuWrapper\">\r\n      <ul>\r\n        <li\r\n          v-for=\"(item, index) in goods\"\r\n          :key=\"index\" class=\"menu-item\"\r\n          :class=\"{'current': currentIndex === index}\"\r\n          @click=\"selectMenu(index, $event)\"\r\n        >\r\n          <span class=\"text\">\r\n            <Icon\r\n              v-show=\"item.type > 0\"\r\n              :itemType = \"item.type\"\r\n              :size = \"312\"\r\n            ></Icon>\r\n            {{item.name}}\r\n          </span>\r\n        </li>\r\n      </ul>\r\n    </div>\r\n    <div class=\"foods-wrapper\" ref=\"foodsWrapper\">\r\n      <ul>\r\n        <li v-for=\"(good, index) in goods\" :key=index class=\"food-list-hook\">\r\n          <ul>\r\n            <span class=\"item-title\">{{good.name}}</span>\r\n            <li\r\n              v-for=\"(item, i) in good.foods\"\r\n              :key=i class=\"food-item\"\r\n            >\r\n              <div class=\"content-swipper\" @click.stop=\"selectFood(item, $event)\">\r\n                <div class=\"icon\">\r\n                  <img width=\"57px\" height=\"57px\" :src=\"item.icon\" alt=\"\">\r\n                </div>\r\n                <div class=\"content\">\r\n                  <h2 class=\"name\">{{item.name}}</h2>\r\n                  <p class=\"desc\">{{item.description}}</p>\r\n                  <div class=\"extra\">\r\n                    <span class=\"count\">月售{{item.sellCount}}份</span>\r\n                    <span>好评率{{item.rating}}</span>\r\n                  </div>\r\n                  <div class=\"price\">\r\n                    <span class=\"new-price\">￥{{item.price}}</span>\r\n                    <span v-show=\"good.oldPrice\" class=\"old-price\">￥{{good.oldPrice}}</span>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <!-- 增加减少控件 -->\r\n              <div class=\"cartcontrol-wrapper\">\r\n                <CartControl\r\n                  :food=\"item\"\r\n                >\r\n                </CartControl>\r\n              </div>\r\n            </li>\r\n          </ul>\r\n        </li>\r\n      </ul>\r\n    </div>\r\n    <ShoopCart\r\n      :deliveryPri=\"seller.deliveryPrice\"\r\n      :minPri=\"seller.minPrice\"\r\n      :selectFoods=\"selectFoods\"\r\n    ></ShoopCart>\r\n    <Food\r\n      :food=\"selectedFood\"\r\n      ref=\"food\"\r\n    ></Food>\r\n  </div>\r\n</template>\r\n\r\n<script type=\"text/ecmascript-6\">\r\nimport Icon from 'components/icon/icon.vue'\r\nimport ShoopCart from 'components/shoopcart/shoopcart.vue'\r\nimport CartControl from 'components/cartcontrol/cartcontrol.vue'\r\nimport Food from 'components/food/food.vue'\r\nimport BScroll from '@better-scroll/core'\r\n\r\nconst ERRNO_OK = 0\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      goods: [],\r\n      listHeight: [],\r\n      scrollY: 0,\r\n      selectedFood: {}\r\n    }\r\n  },\r\n  props: {\r\n    seller: Object\r\n  },\r\n  methods: {\r\n    _initScroll: function() {\r\n      // 获取到这个food-wrapper dom\r\n      this.meunScrll = new BScroll(this.$refs.menuWrapper, {\r\n        click: true\r\n      })\r\n      this.foodsScrll = new BScroll(this.$refs.foodsWrapper, {\r\n        // 会阻止默认行为，需要设置\r\n        click: true,\r\n        // 监听scroll\r\n        probeType: 3\r\n      })\r\n      this.foodsScrll.on('scroll', (pos) => {\r\n        this.scrollY = Math.abs(Math.round(pos.y))\r\n      })\r\n    },\r\n    // 每个类型的高度\r\n    _calculateHeight: function() {\r\n      let foodList = this.$refs.foodsWrapper.getElementsByClassName('food-list-hook')\r\n      // console.log(foodList)\r\n      let height = 0\r\n      this.listHeight.push(height)\r\n      for (let i = 0; i < foodList.length; i++) {\r\n        let item = foodList[i]\r\n        height += item.clientHeight\r\n        this.listHeight.push(height)\r\n      }\r\n    },\r\n    selectMenu: function (index, event) {\r\n      if (!event._constructed) {\r\n        return\r\n      }\r\n      let foodList = this.$refs.foodsWrapper.getElementsByClassName('food-list-hook')\r\n      let el = foodList[index]\r\n      this.foodsScrll.scrollToElement(el, 300)\r\n      this.scrollY = Math.abs(this.listHeight[index])\r\n    },\r\n    selectFood: function (food, event) {\r\n      if (!event._constructed) {\r\n        return\r\n      }\r\n      this.selectedFood = food\r\n      this.$refs.food.show()\r\n    }\r\n  },\r\n  computed: {\r\n    currentIndex: function () {\r\n      for (let i = 0; i < this.listHeight.length - 1; i++) {\r\n        let height1 = this.listHeight[i]\r\n        let height2 = this.listHeight[i + 1]\r\n        if (!height2 || (this.scrollY >= height1 && this.scrollY < height2)) {\r\n          return i\r\n        }\r\n      }\r\n      return 0\r\n    },\r\n    selectFoods: function() {\r\n      let foods = []\r\n      this.goods.forEach((good) => {\r\n        good.foods.forEach((food) => {\r\n          if (food.count) {\r\n            foods.push(food)\r\n          }\r\n        })\r\n      })\r\n      return foods\r\n    }\r\n  },\r\n  created() {\r\n    this.$http.get('http://selladmin.bfclouds.cn/goods.php', {}, { emulateJSON: true }).then((res) => {\r\n      res = res.body\r\n      if (res.errno === ERRNO_OK) {\r\n        this.goods = res.data\r\n        // 处理DOM时一定要保证dom已经渲染\r\n        this.$nextTick(() => {\r\n          this._initScroll()\r\n          this._calculateHeight()\r\n        })\r\n      }\r\n    }).catch((res) => {\r\n      this.goods = []\r\n    })\r\n  },\r\n  components: {\r\n    Icon,\r\n    ShoopCart,\r\n    CartControl,\r\n    Food\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"stylus\" rel=\"stylesheet/stylus\">\r\n@import 'common/stylus/mixin.styl'\r\n\r\n  .goods\r\n    display: flex\r\n    position: absolute\r\n    top: 174px\r\n    bottom: 46px\r\n    width: 100%\r\n    overflow: hidden\r\n    .menu-wrapper\r\n      display: flex\r\n      flex: 0 0 80px  //等分 缩放 占位空间\r\n      width: 80px\r\n      background-color: #f3f5f7\r\n      flex-flow: column wrap\r\n      .menu-item\r\n        display: table\r\n        width: 56px\r\n        height: 54px\r\n        padding: 0 12px\r\n        line-height: 14px\r\n        font-weight: 200\r\n        &.current\r\n          position: relative\r\n          font-size: 12px\r\n          margin-top: -1px\r\n          line-height: 14px\r\n          background: #fff\r\n          font-weight: 700\r\n        .text\r\n          display: table-cell\r\n          width: 56px\r\n          vertical-align: middle\r\n          border-1px(rgba(7, 17, 27, .1))\r\n          font-size: 12px\r\n\r\n    .foods-wrapper\r\n      flex: 1\r\n      .item-title\r\n        display: block\r\n        width: 100%\r\n        height: 26px\r\n        padding-left: 14px\r\n        border-left: 2px solid #d9dde1\r\n        line-height: 26px\r\n        font-size: 12px\r\n        color: rgb(147, 153, 159)\r\n        background-color: #f3f5f7\r\n      .food-item\r\n        display: flex\r\n        margin: 18px 18px 0\r\n        padding-bottom: 18px\r\n        border-1px(rgba(7, 17, 27, .1))\r\n        .content-swipper\r\n          width: 100%\r\n          &:last-child:after\r\n            display: none\r\n          .icon\r\n            flex: 0 0 57px\r\n            margin-right: 10px\r\n          .content\r\n            display: inline-block\r\n            flex: 1\r\n            .name\r\n              margin: 2px 0 8px 0\r\n              height: 14px\r\n              line-height: 14px\r\n              font-size: 14px\r\n              color: rgb(7,1 17, 27)\r\n            .desc\r\n              margin: 8px 0\r\n              font-size: 10px\r\n              line-height: 14px\r\n              color: rgb(147, 153, 159)\r\n              text-overflow: ellipsis\r\n            .extra\r\n              font-size: 10px\r\n              line-height: 10px\r\n              color: rgb(147, 153, 159)\r\n              .count\r\n                margin-right: 12px\r\n            .price\r\n              .new-price\r\n                font-size: 14px\r\n                color: rgb(240,20,20)\r\n                font-weight: 300\r\n                line-height: 24px\r\n              .old-price\r\n                font-size: 10px\r\n                color: rgb(147, 153, 159)\r\n                font-weight: 300\r\n                text-decoration: line-through\r\n        .cartcontrol-wrapper\r\n          position: absolute\r\n          bottom: 10px\r\n          right: 0px\r\n\r\n</style>\r\n"]}]}